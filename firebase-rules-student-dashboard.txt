Firebase Security Rules - Atualiza√ß√£o para Dashboard P√∫blico do Aluno
==========================================================================

Para permitir que o dashboard do aluno funcione sem autentica√ß√£o, voc√™ precisa atualizar as regras do Firebase para permitir acesso p√∫blico √†s seguintes cole√ß√µes:

1. ‚úÖ users (j√° permitido) - para buscar alunos
2. ‚úÖ users/{userId}/students/{studentId} (j√° permitido) - para dados do aluno  
3. ‚ùå users/{userId}/loans (NOVO) - para empr√©stimos do aluno
4. ‚ùå users/{userId}/books (NOVO) - para dados dos livros

REGRAS ATUALIZADAS:
==================

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Permitir leitura da cole√ß√£o users para listar bibliotecas
    match /users/{userId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Permitir acesso p√∫blico aos dados dos alunos
    match /users/{userId}/students/{studentId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // üÜï NOVO: Permitir acesso p√∫blico aos empr√©stimos para dashboard do aluno
    match /users/{userId}/loans/{loanId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // üÜï NOVO: Permitir acesso p√∫blico aos dados dos livros para dashboard do aluno
    match /users/{userId}/books/{bookId} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Demais regras permanecem iguais
    match /users/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    match /globalNotifications/{document=**} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.email == 'admin@admin.com';
    }
    
    match /publicData/{document=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}

INSTRU√á√ïES:
===========

1. Acesse o Console do Firebase (https://console.firebase.google.com)
2. V√° para seu projeto
3. Navegue at√© "Firestore Database" > "Rules"
4. Substitua as regras atuais pelas regras acima
5. Clique em "Publish" para aplicar as mudan√ßas

IMPORTANTE:
===========

‚ö†Ô∏è  Estas regras permitem acesso p√∫blico (sem autentica√ß√£o) aos dados de:
   - Alunos
   - Empr√©stimos 
   - Livros
   
   Isso √© necess√°rio para o dashboard p√∫blico funcionar, mas significa que qualquer pessoa
   com um ID de aluno v√°lido pode acessar esses dados.

‚úÖ  As opera√ß√µes de escrita (write) ainda requerem autentica√ß√£o, mantendo a seguran√ßa.

‚úÖ  Somente as opera√ß√µes de leitura (read) s√£o p√∫blicas.

TESTE AP√ìS APLICAR:
==================

1. Salve este arquivo
2. Aplique as regras no Firebase Console  
3. Teste o login do aluno para verificar se o dashboard carrega corretamente
4. Verifique se os gr√°ficos e m√©tricas aparecem quando h√° dados de empr√©stimos

Se tiver problemas, verifique o console do navegador para mensagens de erro relacionadas √†s permiss√µes do Firebase.
