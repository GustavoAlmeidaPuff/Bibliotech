MUDANÃ‡AS NECESSÃRIAS NAS REGRAS DO FIREBASE
===========================================

Suas regras atuais estÃ£o quase corretas! VocÃª sÃ³ precisa alterar 2 linhas especÃ­ficas:

ðŸ”§ MUDANÃ‡A 1: Permitir leitura pÃºblica dos EMPRÃ‰STIMOS
======================================================

ATUAL (linha ~35):
    match /users/{userId}/loans/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

NOVO:
    match /users/{userId}/loans/{document=**} {
      allow read: if true; // ðŸ†• MUDANÃ‡A: Permite leitura pÃºblica dos emprÃ©stimos
      allow write: if request.auth != null && request.auth.uid == userId;
    }

ðŸ”§ MUDANÃ‡A 2: Permitir leitura pÃºblica dos LIVROS
=================================================

ATUAL (linha ~31):
    match /users/{userId}/books/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

NOVO:
    match /users/{userId}/books/{document=**} {
      allow read: if true; // ðŸ†• MUDANÃ‡A: Permite leitura pÃºblica dos livros
      allow write: if request.auth != null && request.auth.uid == userId;
    }

ðŸ“‹ REGRAS FINAIS COMPLETAS
==========================

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Regra para permitir leitura de metadados dos usuÃ¡rios (necessÃ¡rio para listar usuÃ¡rios)
    match /users/{userId} {
      allow read: if true; // Permite leitura dos documentos de usuÃ¡rio para buscar bibliotecas
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Regra especÃ­fica para permitir leitura pÃºblica dos dados dos alunos
    match /users/{userId}/students/{studentId} {
      allow read: if true; // Permite leitura pÃºblica dos dados dos alunos
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Permitir leitura pÃºblica das coleÃ§Ãµes students (para listar)
    match /users/{userId}/students {
      allow read: if true; // Permite listar alunos
    }
    
    // ðŸ†• MUDANÃ‡A: Regras para livros - agora com leitura pÃºblica
    match /users/{userId}/books/{document=**} {
      allow read: if true; // ðŸ†• NOVA: Permite leitura pÃºblica dos livros
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ðŸ†• MUDANÃ‡A: Regras para emprÃ©stimos - agora com leitura pÃºblica
    match /users/{userId}/loans/{document=**} {
      allow read: if true; // ðŸ†• NOVA: Permite leitura pÃºblica dos emprÃ©stimos
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Regras restritivas para outros documentos dos usuÃ¡rios (SEM MUDANÃ‡A)
    match /users/{userId}/staff/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    match /users/{userId}/classes/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    match /users/{userId}/settings/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Regra para notificaÃ§Ãµes globais - apenas admin pode escrever (SEM MUDANÃ‡A)
    match /globalNotifications/{document=**} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.email == 'admin@admin.com';
    }
    
    // Regra para dados pÃºblicos - todos podem ler, apenas usuÃ¡rios autenticados podem escrever (SEM MUDANÃ‡A)
    match /publicData/{document=**} {
      allow read: if true; // Qualquer um pode ler dados pÃºblicos
      allow write: if request.auth != null; // Apenas usuÃ¡rios autenticados podem escrever
    }
  }
}

âœ… RESUMO DAS MUDANÃ‡AS
======================

VocÃª sÃ³ precisa mudar 2 linhas:

1ï¸âƒ£ Na seÃ§Ã£o de books: `allow read, write: if request.auth != null && request.auth.uid == userId;`
   PARA: `allow read: if true; allow write: if request.auth != null && request.auth.uid == userId;`

2ï¸âƒ£ Na seÃ§Ã£o de loans: `allow read, write: if request.auth != null && request.auth.uid == userId;`
   PARA: `allow read: if true; allow write: if request.auth != null && request.auth.uid == userId;`

ðŸ”’ SEGURANÃ‡A MANTIDA
====================

âœ… Escrita (write) ainda requer autenticaÃ§Ã£o
âœ… Staff, classes e settings continuam protegidos
âœ… Apenas leitura (read) de books e loans ficou pÃºblica
âœ… Aluno precisa saber o ID especÃ­fico para acessar

ðŸš€ APÃ“S APLICAR
===============

1. Copie as regras finais acima
2. Cole no Firebase Console > Firestore > Rules
3. Clique em "Publish"
4. Teste o dashboard do aluno
